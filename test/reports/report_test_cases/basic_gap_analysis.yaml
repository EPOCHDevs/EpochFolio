tests:
  - title: "Basic Gap Analysis - Mixed Gaps"
    input:
      type: "gap_data"
      # 10 days of gap data - using string dates
      timestamps: [
        "2022-01-01T09:30:00",
        "2022-01-02T09:30:00",
        "2022-01-03T09:30:00",
        "2022-01-04T09:30:00",
        "2022-01-05T09:30:00",
        "2022-01-06T09:30:00",
        "2022-01-07T09:30:00",
        "2022-01-08T09:30:00",
        "2022-01-09T09:30:00",
        "2022-01-10T09:30:00"
      ]
      gap_up: [true, false, true, false, true, false, true, false, true, false]
      gap_down: [false, true, false, true, false, true, false, true, false, true]
      fill_fraction: [0.8, 0.3, 0.9, 0.2, 0.7, 0.4, 0.85, 0.15, 0.75, 0.35]
      gap_size: [0.025, -0.022, 0.030, -0.028, 0.020, -0.025, 0.035, -0.030, 0.022, -0.027]
      psc: [400.0, 401.0, 402.0, 403.0, 404.0, 405.0, 406.0, 407.0, 408.0, 409.0]
      c: [410.25, 399.78, 412.30, 399.72, 408.20, 399.75, 414.35, 399.70, 410.22, 399.73]
      psc_timestamp: [
        "2021-12-31T16:00:00",  # Previous day for each
        "2022-01-01T16:00:00",
        "2022-01-02T16:00:00",
        "2022-01-03T16:00:00",
        "2022-01-04T16:00:00",
        "2022-01-05T16:00:00",
        "2022-01-06T16:00:00",
        "2022-01-07T16:00:00",
        "2022-01-08T16:00:00",
        "2022-01-09T16:00:00"
      ]
    expect:
      type: "tearsheet"
      cards:
        - data:
          - title: "Total Gaps"
            value: 10
        - data:
          - title: "Gap Up"
            value: 5
          - title: "Gap Down"
            value: 5
        - data:
          - title: "Overall Fill Rate"
            value: 50.0  # 5 filled gaps (>0.5) out of 10 total = 50%
        - data:
          - title: "Avg Gap %"
            value: 2.55  # Average of abs(gap_size) * 100
          - title: "Max Gap %"
            value: 3.5   # Max of abs(gap_size) * 100
    options:
      report_type: "gap_report"
      instance_id: "basic_gap_test"

  - title: "High Fill Rate Scenario"
    input:
      type: "gap_data"
      timestamps: [
        "2022-01-01T09:30:00",
        "2022-01-02T09:30:00",
        "2022-01-03T09:30:00",
        "2022-01-04T09:30:00",
        "2022-01-05T09:30:00"
      ]
      gap_up: [true, true, false, true, false]
      gap_down: [false, false, true, false, true]
      fill_fraction: [0.95, 0.90, 0.85, 0.92, 0.88]
      gap_size: [0.030, 0.025, -0.020, 0.035, -0.022]
      psc: [400.0, 401.0, 402.0, 403.0, 404.0]
      c: [412.0, 411.25, 399.8, 414.1, 399.9]
      psc_timestamp: [
        "2021-12-31T16:00:00",
        "2022-01-01T16:00:00",
        "2022-01-02T16:00:00",
        "2022-01-03T16:00:00",
        "2022-01-04T16:00:00"
      ]
    expect:
      type: "tearsheet"
      cards:
        - data:
          - title: "Total Gaps"
            value: 5
        - data:
          - title: "Gap Up"
            value: 3
          - title: "Gap Down"
            value: 2
        - data:
          - title: "Overall Fill Rate"
            value: 100.0  # 5 filled gaps (all >0.5) out of 5 total = 100%
        - data:
          - title: "Avg Gap %"
            value: 2.64  # Average of abs(gap_size) * 100
          - title: "Max Gap %"
            value: 3.5   # Max of abs(gap_size) * 100
    options:
      report_type: "gap_report"
      instance_id: "high_fill_rate_test"